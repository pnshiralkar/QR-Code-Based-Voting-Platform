<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>PICS-O-REEL</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/static/cssall.css">
    <!-- Bootstrap core CSS -->
    <link href="static/css/bootstrap.min.css" rel="stylesheet">

    <!-- Material Design Bootstrap -->
    <link href="static/css/mdb.min.css" rel="stylesheet">


    <!--My stylesheets-->
    <link href="static/css/style.css" rel="stylesheet">

    <style type="text/css">
        @media (min-width: 800px) and (max-width: 850px) {
            .navbar:not(.top-nav-collapse) {
                background: #1C2331 !important;
            }
        }
    </style>

    <style>
        .drawingBuffer {
            position: absolute;
            left: 4%;
            width: 92%;
        }
        
        video {
            width: 100%;
        }
    </style>
    <script src="static/js/vendor/jquery-1.9.0.min.js"></script>
    <script src="static/js/quagga.min.js"></script>
    <script src="static/js/live_w_locator.js"></script>
    <!-- JQuery -->
    <script type="text/javascript" src="static/js/jquery-3.4.1.min.js"></script>
    <script type="text/javascript">
        function barcode(code) {
            var bool = false;

            if ((code[0].match(/[a-z]/i) && code[2].match(/[a-z]/i) && code.length === 11) || (code.length === 4 && Number.isInteger(code)  )) {
                console.log(code);
                // start loading a(if possible pause video)
                $(".loading").show();
                $.ajax({
                    url: "/login",
                    method: "post",
                    data: {
                        'username': code
                    },
                    timeout: 3000,
                    success: function(res) {
                        console.log(res);

                        if (res.success)
                            window.location = "/vote";
                        else {
                            alert(res.status);
                            // stop loading (play vdo again)
                            $(".loading").hide();
                        }
                    },
                    fail: function() {
                        $(".loading").hide();
                    }
                })

            }
        }

        $(document).ready(function() {
            $("a[data-target*='#barcodeModal']").click(() => {
                startCam();
            });

            $(".loading").hide();

            document.getElementById("Manual").onclick = function() {
                var bool = false;
                var code = document.getElementById("idManual").value;

                if ((code[0].match(/[a-z]/i) && code[2].match(/[a-z]/i) && code.length === 11) || (code.length === 4 && Number.isInteger(code[0]) && Number.isInteger(code[1]) && Number.isInteger(code[2]) && Number.isInteger(code[3]))) {
                    $(".loading").show();
                    $.ajax({
                        url: "/login",
                        method: "post",
                        data: {
                            'username': code
                        },
                        timeout: 3000,
                        success: function(res) {
                            console.log(res);
                            $(".loading").hide();
                            if (res.success)
                                window.location = "/vote";
                            else {
                                alert(res.status);
                                // stop loading (play vdo again)
                            }
                        },
                        fail: function() {
                            $(".loading").hide();
                        }

                    })
                } else
                    alert("Invalid User");
            }

        });
    </script>
</head>

<body>



    <!--Carousel Wrapper-->
    <div id="carousel-example-1z" class="carousel slide carousel-fade" data-ride="carousel">

        <!--Slides-->
        <div class="carousel-inner" role="listbox">

            <!--First slide-->
            <div class="carousel-item active">
                <div class="view" style="background-image: url('https://images.pexels.com/photos/33109/fall-autumn-red-season.jpg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940'); background-repeat: no-repeat; background-size: cover;">

                    <!-- Mask & flexbox options-->
                    <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

                        <!-- Content -->
                        <div class="text-center white-text mx-5 wow fadeIn">
                            <h1 class="display-5">
                                PICS-O-REEL
                            </h1>
                            <p>
                                <strong>A PICTOREAL EVENT</strong>
                            </p>

                            <a target="_blank" class="btn btn-outline-white btn-lg" data-toggle="modal" data-target="#barcodeModal">LOGIN
                                <i class="fas fa-sign-in-alt ml-2"></i>
                              </a>
                        </div>
                        <!-- Content -->

                    </div>
                    <!-- Mask & flexbox options-->

                </div>
            </div>
            <!--/First slide-->

            <!--Second slide-->
            <div class="carousel-item">
                <div class="view" style="background-image: url('https://images.pexels.com/photos/1562/italian-landscape-mountains-nature.jpg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940'); background-repeat: no-repeat; background-size: cover;">

                    <!-- Mask & flexbox options-->
                    <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

                        <!-- Content -->
                        <div class="text-center white-text mx-5 wow fadeIn">
                            <h1 class="display-5">
                                PICS-O-REEL
                            </h1>
                            <p>
                                <strong>A PICTOREAL EVENT</strong>
                            </p>

                            <a target="_blank" class="btn btn-outline-white btn-lg" data-toggle="modal" data-target="#barcodeModal">LOGIN
                                <i class="fas fa-sign-in-alt ml-2"></i>
                              </a>
                        </div>
                        <!-- Content -->

                    </div>
                    <!-- Mask & flexbox options-->

                </div>
            </div>
            <!--/Second slide-->

            <!--Third slide-->
            <div class="carousel-item">
                <div class="view" style="background-image: url('https://images.pexels.com/photos/1421903/pexels-photo-1421903.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940'); background-repeat: no-repeat; background-size: cover;">

                    <!-- Mask & flexbox options-->
                    <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

                        <!-- Content -->
                        <div class="text-center white-text mx-5 wow fadeIn">
                            <h1 class="display-5">
                                PICS-O-REEL
                            </h1>
                            <p>
                                <strong>A PICTOREAL EVENT</strong>
                            </p>

                            <a target="_blank" class="btn btn-outline-white btn-lg" data-toggle="modal" data-target="#barcodeModal">LOGIN
                <i class="fas fa-sign-in-alt ml-2"></i>
              </a>
                        </div>
                        <!-- Content -->

                    </div>
                    <!-- Mask & flexbox options-->

                </div>
            </div>
            <!--/Third slide-->

        </div>
        <!--/.Slides-->

    </div>
    <!--/.Carousel Wrapper-->


    <!-- Barcode MODAL -->
    <div class="modal" id="barcodeModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-white">Login</h5>
                    <button class="close" onclick="Quagga.stop()" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <div data-v-8d1d8f02="" data-v-d5007954="" id="interactive" class="viewport scanner">

                        <div class="container text-white align-items-center">
                            <div class="row">
                                <div class="col-auto loading" style="background-color: rgba(0,0,0,0.5)">
                                    <div class="spinner-border text-light loading" role="status">
                                        <span class="sr-only loading">Loading...</span>
                                    </div> Logging in...
                                </div>
                            </div>
                        </div>
                        <video data-v-8d1d8f02=""></video>
                        <canvas data-v-8d1d8f02="" class="drawingBuffer"></canvas>
                    </div>
                </div>
                <div class="modal-footer">
                    <h5 class="text-white"><a href="#collapse2" data-toggle="collapse">Manual login</a></h5>
                    <div id="collapse2" class="collapse">
                        <div class="card-body">
                            <form>
                                <div class="form-group text-white">
                                    <label for="username">ID</label>
                                    <input type="text" placeholder="Username" class="form-control" id="idManual">
                                </div>
                            </form>
                            <button class="btn btn-primary" id="Manual">Login</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <!-- LOGIN MODAL -->
    <div class="modal" id="loginModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-white">Login</h5>
                    <button class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group text-white">
                            <label for="username">Username</label>
                            <input type="text" placeholder="Username" class="form-control">
                        </div>
                        <div class="form-group text-white">
                            <label for="password">Password</label>
                            <input type="password" placeholder="Password" class="form-control">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button class="btn btn-primary" data-dismiss="modal">Login</button>
                </div>
            </div>
        </div>
    </div>

    <footer class="page-footer text-center font-small mt-4 wow fadeIn">

        <hr class="my-4">

        <!-- Social icons -->
        <div class="pb-4">
            <a href="https://www.facebook.com/pictoreal/" target="_blank">
                <i class="fab fa-facebook-f mr-3"></i>
            </a>

            <a href="https://www.instagram.com/pictoreal/" target="_blank">
                <i class="fab fa-instagram mr-3"></i>
            </a>

            <a href="mailto:pictoreal@pict.edu" target="_blank">
                <i class="fas fa-envelope mr-3"></i>
            </a>

        </div>
        <!-- Social icons -->

        <!--Copyright-->
        <div class="footer-copyright py-3">
            Â©
            <a href="https://pictoreal.in/" target="_blank"> PICTOREAL </a> 2019
        </div>
        <!--/.Copyright-->

    </footer>

    <!-- SCRIPTS -->
    <!-- Bootstrap tooltips -->
    <script type="text/javascript" src="static/js/popper.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="static/js/bootstrap.min.js"></script>
    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="static/js/mdb.min.js"></script>
    <!-- Initializations -->
    <script type="text/javascript">
        // Animations initialization
        new WOW().init();
    </script>
